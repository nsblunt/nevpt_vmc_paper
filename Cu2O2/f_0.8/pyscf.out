#INFO: **** input file is /state/partition1/nsb37/161410/prepVMC.py ****
import numpy as np
from pyscf import gto, scf, ao2mo, mcscf, tools, fci, mp, symm, lib
from pyscf.shciscf import shci
import math, os, time, sys
#import NEVPT2Helper as nev

def myocc(mf):
   mol = mf.mol
   irrep_id = mol.irrep_id
   so = mol.symm_orb
   orbsym = symm.label_orb_symm(mol, irrep_id, so, mf.mo_coeff)
   doccsym = np.array(orbsym)[mf.mo_occ==2]
   soccsym = np.array(orbsym)[mf.mo_occ==1]
   for ir, irname in enumerate(mol.irrep_name):
     print('%s, double-occ = %d, single-occ = %d' %
         (irname, sum(doccsym==ir), sum(soccsym==ir)))

# Cu2O2^2+: bis f = 0., per f = 1.
if len(sys.argv) == 2:
    f = float(sys.argv[1])
else:
    f = 0.

# bond lengths
cu_cu = 2.8 + f * 0.8
o_o = 2.3 - f * 0.9

#atomString = f'Cu {-cu_cu/2} 0. 0.; Cu {cu_cu/2} 0. 0.; O 0. {o_o/2} 0.; O 0. {-o_o/2} 0.'
atomString = 'Cu {} 0. 0.; Cu {} 0. 0.; O 0. {} 0.; O 0. {} 0.'.format(-cu_cu/2, cu_cu/2, o_o/2, -o_o/2)

mol = gto.M(atom = atomString,
    basis = {'O': gto.basis.parse('''
O    S
 105374.95                   0.00012386            -0.00002815             0.00002616            -0.00005058             0.00005196
  15679.240                  0.00051201            -0.00011630             0.00010748            -0.00020024             0.00019612
   3534.5447                 0.00215291            -0.00049092             0.00045972            -0.00091952             0.00099303
    987.36516                0.00852844            -0.00194616             0.00179555            -0.00320240             0.00297658
    315.97875                0.03018049            -0.00700530             0.00667574            -0.01359974             0.01564071
    111.65428                0.09099702            -0.02167814             0.02053445            -0.03392296             0.03231923
     42.699451               0.21779364            -0.05641213             0.05828602            -0.11685462             0.16012253
     17.395596               0.36862457            -0.11270530             0.12129691            -0.14040275             0.15386867
      7.4383090              0.33667073            -0.15891197             0.22641475            -0.47546666             0.93886300
      3.2228620              0.09657630            -0.03355083            -0.04238700             0.83350096            -3.16442722
      1.2538770              0.00214452             0.35319028            -1.01045538             1.30186138             2.94545392
       .49515500             0.00119435             0.55341993            -0.15386868            -2.48175844            -0.46724256
       .19166500             0.00053902             0.23018391             0.99345320             0.81134659            -1.59503813
       .06708300             0.00021034             0.01127267             0.18587254             0.58210417             1.34403482
O    P
    200.00000                0.00091730            -0.00087213             0.00129603            -0.00195602
     46.533367               0.00737714            -0.00706424             0.01151279            -0.02399585
     14.621809               0.03483515            -0.03330489             0.05159120            -0.09118427
      5.3130640              0.11443970            -0.11441275             0.20459407            -0.52863388
      2.1025250              0.25549664            -0.29901068             0.55019345            -0.38198314
       .85022300             0.37225574            -0.31986054            -0.14872038             1.44198816
       .33759700             0.33233149             0.20550900            -0.89690085            -0.67366146
       .12889200             0.14008479             0.59359268             0.24707597            -0.66496950
       .04511200             0.02395784             0.28229027             0.64443405             0.82977107
O    D
      3.7500000              0.13609758            -0.39151953             0.95199748
      1.3125000              0.51401475            -0.62262728            -0.67736624
       .45937500             0.47407125             0.72160073            -0.34608569
       .16078100             0.08166905             0.31870103             0.81524547
O    F
      2.3500000              0.33460642            -0.83677707
       .94000000             0.56136672             0.10721970
       .37600000             0.29572786             0.72955061
O    G
      1.175000               0.89524901
      0.470000               0.166642351
    '''),
    'Cu': gto.basis.parse('''
Cu    S
9148883.                     0.00011722            -0.00003675             0.00001383            -0.00000271             0.00000346            -0.00001401             0.00001043
1369956.                     0.00033155            -0.00010403             0.00003914            -0.00000766             0.00000979            -0.00003959             0.00002948
 311782.6                    0.00088243            -0.00027733             0.00010439            -0.00002047             0.00002626            -0.00010612             0.00007887
  88318.80                   0.00217229            -0.00068417             0.00025745            -0.00005030             0.00006392            -0.00025900             0.00019337
  28815.53                   0.00529547            -0.00167686             0.00063203            -0.00012442             0.00016087            -0.00064865             0.00048021
  10403.46                   0.01296630            -0.00413460             0.00155718            -0.00030269             0.00038023            -0.00154770             0.00116372
   4057.791                  0.03188050            -0.01035127             0.00391659            -0.00077628             0.00101716            -0.00408342             0.00300351
   1682.974                  0.07576569            -0.02534791             0.00959476            -0.00185240             0.00229152            -0.00940206             0.00715331
    733.7543                 0.16244637            -0.05836947             0.02238837            -0.00448270             0.00597497            -0.02389117             0.01749000
    333.2677                 0.28435959            -0.11673284             0.04528606            -0.00866024             0.01044695            -0.04359832             0.03399715
    156.4338                 0.34173643            -0.18466860             0.07498378            -0.01544726             0.02151583            -0.08588857             0.06315941
     74.69721                0.20955087            -0.14700899             0.06188170            -0.01089864             0.01030128            -0.04734865             0.04023075
     33.32262                0.03544751             0.18483257            -0.09047327             0.01467867            -0.00984324             0.06382592            -0.07818080
     16.62237               -0.00243996             0.56773609            -0.39288472             0.09154122            -0.14292630             0.59363541            -0.48734052
      8.208260               0.00146990             0.37956092            -0.35664956             0.06330857            -0.05612707             0.41506062            -0.33346978
      3.609400              -0.00064379             0.04703755             0.34554793            -0.06093879             0.09135650            -1.70027942             2.60302086
      1.683449               0.00024738            -0.00072783             0.70639197            -0.27148545             0.45831402            -0.29799956            -2.74603469
      0.733757              -0.00008118             0.00102976             0.25335911            -0.10138944            -0.19726740             1.70719425             0.71954394
      0.110207               0.00001615            -0.00007020             0.00658749             0.71212180            -1.30310157            -0.65600053             1.53198225
      0.038786              -0.00001233             0.00007090            -0.00044247             0.34613175             0.87975568            -0.31924524            -3.06314771
      0.015514               0.00000452            -0.00002454             0.00072338             0.07198709             0.57310889             0.61772456             2.02100706
Cu    P
   9713.253                  0.00039987            -0.00014879             0.00005053            -0.00015878             0.00012679            -0.00022000
   2300.889                  0.00210157            -0.00078262             0.00026719            -0.00085359             0.00068397            -0.00104834
    746.7706                 0.01001097            -0.00376229             0.00127718            -0.00399919             0.00320291            -0.00581612
    284.6806                 0.03836039            -0.01457968             0.00499760            -0.01608092             0.01301351            -0.01983336
    119.9999                 0.11626756            -0.04571093             0.01561376            -0.04924864             0.04021371            -0.07638917
     54.07386                0.25899831            -0.10593013             0.03689701            -0.12165679             0.10150109            -0.15366480
     25.37321                0.38428226            -0.16836228             0.05796469            -0.17713367             0.13700954            -0.28449754
     12.20962                0.29911210            -0.10373213             0.03791966            -0.14448197             0.10628972             0.10206373
      5.757421               0.08000672             0.21083155            -0.11706499             0.64743311            -0.83390265             1.55100061
      2.673402               0.00319440             0.48916443            -0.20912257             0.54797692             0.14412002            -1.84574442
      1.186835               0.00147252             0.38468638            -0.05800532            -0.78180321             0.98301239             0.10057714
      0.481593              -0.00023391             0.08529338             0.16430736            -0.52607778            -0.52956418             1.39430453
      0.192637               0.00020761            -0.00161045             0.52885466             0.22437177            -0.75303984            -1.12548146
      0.077055              -0.00008963             0.00206530             0.37373016             0.33392453             0.44288700            -0.18571375
      0.030822               0.00002783            -0.00064175             0.08399866             0.14446374             0.57511589             0.70628395
Cu    D
    249.3497                 0.00134561            -0.00158359             0.00191116            -0.00316569
     74.63837                0.01080983            -0.01281116             0.01772495            -0.03710740
     28.37641                0.04733793            -0.05642679             0.07056381            -0.12591409
     11.94893                0.13772582            -0.16641393             0.22906101            -0.49360952
      5.317646               0.26263833            -0.35106014             0.43938511            -0.16251663
      2.364417               0.33470401            -0.23717890            -0.26739908             1.00715586
      1.012386               0.31000597             0.21994641            -0.62590624            -0.32192167
      0.406773               0.21316819             0.48841363             0.12211340            -0.61072690
      0.147331               0.07865365             0.29537131             0.53683629             0.39038140
      0.058932               0.00603096             0.04295539             0.19750055             0.37334893
Cu    F
     15.4333                 0.03682063            -0.06200336             0.13301012
      6.1172                 0.24591418            -0.52876669             0.74591931
      2.4246                 0.50112688            -0.29078386            -0.67622545
      0.9610                 0.35850648             0.52124157            -0.31278443
      0.3809                 0.14728062             0.37532205             0.60308069
      0.1510                 0.02564748             0.10659798             0.26056742
Cu    G
      8.7286                 0.16903848            -0.45244412
      3.4308                 0.60654185            -0.42317767
      1.3485                 0.37979899             0.61107957
      0.5300                 0.10367757             0.39786263
Cu    H
      4.2885                 0.69861274
      1.6856                 0.445143741
    ''')},
    verbose = 4, unit = 'angstrom', symmetry = 1, spin = 0, charge = 2)
mf = scf.RHF(mol)
mf.max_cycle = 500
mf.chkfile = 'cu2o2_{}_HF.chk'.format(f)
mf.kernel()
myocc(mf)
mf.analyze()
#tools.molden.from_mo(mol, f'cu2o2_{f}.molden', mf.mo_coeff)

# shciscf
norbAct = 32
nelecAct = 28
mc = shci.SHCISCF(mf, norbAct, nelecAct)
mc.chkfile = 'cu2o2_{}_SHCISCF.chk'.format(f)
#
# for icpt integrals uncomment the following and comment out the mc calculation, FCIDUMP generation, etc.
#chkfile = f'{n}_SHCISCF.chk'
#mc.__dict__.update(lib.chkfile.load(chkfile, 'mcscf'))
#
# active space: Cu 3d, 4d; O 2p, 3p
mo = mc.sort_mo_by_irrep({'Ag': 6,'B1u': 4,'B2u': 4, 'B3g': 4, 'B3u': 6, 'B2g': 2, 'B1g': 4, 'Au': 2},
    {'Ag': 7,'B1u': 2,'B2u': 4, 'B3g': 0, 'B3u': 5,'B2g': 2, 'B1g': 2, 'Au': 0})
#
mc.fcisolver.sweep_iter = [0, 3, 6]
mc.fcisolver.sweep_epsilon = [1e-3, 5e-4, 1e-4]
mc.fcisolver.nPTiter = 0
#mc.max_cycle_macro = 20
#mc.internal_rotation = True
mc.fcisolver.nPTiter = 0  # Turns off PT calculation, i.e. no PTRDM.
#mc.fcisolver.mpiprefix = "mpirun -np 24"
#mc.fcisolver.prefix = "/rc_scratch/anma2640/cu2o2/"
mc.mc1step(mo)[0]

tools.molden.from_mo(mol, 'cu2o2_{}.molden'.format(f), mc.mo_coeff)
# prep nevpt

norbFrozen = 12
norbCore = 22

fileh = open("moEne.txt", 'w')
for i in range(mol.nao - norbFrozen):
  fileh.write('%.12e\n'%(mc.mo_energy[i + norbFrozen]))
fileh.close()

tools.fcidump.from_mc(mc, 'FCIDUMP_all_orbs', nFrozen = norbFrozen)

# active space integrals for dice calculation
mo_core = mc.mo_coeff[:,:norbCore]
mo_rest = mc.mo_coeff[:,norbCore:norbCore + norbAct]
core_dm = 2 * mo_core.dot(mo_core.T)
corevhf = mc.get_veff(mol, core_dm)
energy_core = mol.energy_nuc()
energy_core += np.einsum('ij,ji', core_dm, mc.get_hcore())
energy_core += np.einsum('ij,ji', core_dm, corevhf) * .5
h1eff = mo_rest.T.dot(mc.get_hcore() + corevhf).dot(mo_rest)
eri = ao2mo.kernel(mol, mo_rest)
tools.fcidump.from_integrals('FCIDUMP', h1eff, eri, norbAct, nelecAct, energy_core)

#this is the scratch file for writing potentially larger integral files
#intfolder = "int/"
#os.system("mkdir -p "+intfolder)
##
#
#dm2a = np.zeros((norb, norb, norb, norb))
#file2pdm = "spatialRDM.0.0.txt"
#file2pdm = file2pdm.encode()  # .encode for python3 compatibility
#shci.r2RDM(dm2a, norb, file2pdm)
#dm1 = np.einsum('ikjj->ki', dm2a)
#dm1 /= (nelec - 1)
##dm1, dm2a = mc.fcisolver.make_rdm12(0, mc.ncas, mc.nelecas)
#dm2 = np.einsum('ijkl->ikjl', dm2a)
##
#np.save(intfolder+"E2.npy", np.asfortranarray(dm2))
#np.save(intfolder+"E1.npy", np.asfortranarray(dm1))
##
#print ("trace of 2rdm", np.einsum('ijij',dm2))
#print ("trace of 1rdm", np.einsum('ii',dm1))
##
#E1eff = dm1 #for state average
#nev.writeNEVPTIntegrals(mc, dm1, dm2, E1eff, norbFrozen, intfolder)
#nev.write_ic_inputs(mc.nelecas[0]+mc.nelecas[1], mc.ncore, mc.ncas, norbFrozen, mc.nelecas[0]-mc.nelecas[1],
#                   'NEVPT2')
#INFO: ******************** input file end ********************


System: ('Linux', 'compute-0-25.local', '2.6.32-504.16.2.el6.x86_64', '#1 SMP Wed Apr 22 06:48:29 UTC 2015', 'x86_64', 'x86_64')  Threads 16
Python 2.7.15 |Anaconda, Inc.| (default, May  1 2018, 23:32:55) 
[GCC 7.2.0]
numpy 1.15.1  scipy 1.1.0
Date: Wed Jul  1 19:31:22 2020
PySCF version 1.7.1
PySCF path  /home/nsb37/pyscf/pyscf
GIT ORIG_HEAD f9a419e89c2fa6ea63cd0445a6fc1dde4109b47b
GIT HEAD      ref: refs/heads/master
GIT master branch  97008722ba492c9d60fa46535f156620355ae933

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 4
[INPUT] num. electrons = 72
[INPUT] charge = 2
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry 1 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 Cu    -1.720000000000   0.000000000000   0.000000000000 AA   -3.250328934252   0.000000000000   0.000000000000 Bohr
[INPUT]  2 Cu     1.720000000000   0.000000000000   0.000000000000 AA    3.250328934252   0.000000000000   0.000000000000 Bohr
[INPUT]  3 O      0.000000000000   0.790000000000   0.000000000000 AA    0.000000000000   1.492883638406   0.000000000000 Bohr
[INPUT]  4 O      0.000000000000  -0.790000000000   0.000000000000 AA    0.000000000000  -1.492883638406   0.000000000000 Bohr

nuclear repulsion = 410.257942611815
point group symmetry = D2h
num. orbitals of irrep Ag = 58
num. orbitals of irrep B1g = 36
num. orbitals of irrep B2g = 30
num. orbitals of irrep B3g = 26
num. orbitals of irrep Au = 20
num. orbitals of irrep B1u = 36
num. orbitals of irrep B2u = 45
num. orbitals of irrep B3u = 49
number of shells = 22
number of NR pGTOs = 632
number of NR cGTOs = 300
basis = {'Cu': [[0, [9148883.0, 0.00011722, -3.675e-05, 1.383e-05, -2.71e-06, 3.46e-06, -1.401e-05, 1.043e-05], [1369956.0, 0.00033155, -0.00010403, 3.914e-05, -7.66e-06, 9.79e-06, -3.959e-05, 2.948e-05], [311782.6, 0.00088243, -0.00027733, 0.00010439, -2.047e-05, 2.626e-05, -0.00010612, 7.887e-05], [88318.8, 0.00217229, -0.00068417, 0.00025745, -5.03e-05, 6.392e-05, -0.000259, 0.00019337], [28815.53, 0.00529547, -0.00167686, 0.00063203, -0.00012442, 0.00016087, -0.00064865, 0.00048021], [10403.46, 0.0129663, -0.0041346, 0.00155718, -0.00030269, 0.00038023, -0.0015477, 0.00116372], [4057.791, 0.0318805, -0.01035127, 0.00391659, -0.00077628, 0.00101716, -0.00408342, 0.00300351], [1682.974, 0.07576569, -0.02534791, 0.00959476, -0.0018524, 0.00229152, -0.00940206, 0.00715331], [733.7543, 0.16244637, -0.05836947, 0.02238837, -0.0044827, 0.00597497, -0.02389117, 0.01749], [333.2677, 0.28435959, -0.11673284, 0.04528606, -0.00866024, 0.01044695, -0.04359832, 0.03399715], [156.4338, 0.34173643, -0.1846686, 0.07498378, -0.01544726, 0.02151583, -0.08588857, 0.06315941], [74.69721, 0.20955087, -0.14700899, 0.0618817, -0.01089864, 0.01030128, -0.04734865, 0.04023075], [33.32262, 0.03544751, 0.18483257, -0.09047327, 0.01467867, -0.00984324, 0.06382592, -0.0781808], [16.62237, -0.00243996, 0.56773609, -0.39288472, 0.09154122, -0.1429263, 0.59363541, -0.48734052], [8.20826, 0.0014699, 0.37956092, -0.35664956, 0.06330857, -0.05612707, 0.41506062, -0.33346978], [3.6094, -0.00064379, 0.04703755, 0.34554793, -0.06093879, 0.0913565, -1.70027942, 2.60302086], [1.683449, 0.00024738, -0.00072783, 0.70639197, -0.27148545, 0.45831402, -0.29799956, -2.74603469], [0.733757, -8.118e-05, 0.00102976, 0.25335911, -0.10138944, -0.1972674, 1.70719425, 0.71954394], [0.110207, 1.615e-05, -7.02e-05, 0.00658749, 0.7121218, -1.30310157, -0.65600053, 1.53198225], [0.038786, -1.233e-05, 7.09e-05, -0.00044247, 0.34613175, 0.87975568, -0.31924524, -3.06314771], [0.015514, 4.52e-06, -2.454e-05, 0.00072338, 0.07198709, 0.57310889, 0.61772456, 2.02100706]], [1, [9713.253, 0.00039987, -0.00014879, 5.053e-05, -0.00015878, 0.00012679, -0.00022], [2300.889, 0.00210157, -0.00078262, 0.00026719, -0.00085359, 0.00068397, -0.00104834], [746.7706, 0.01001097, -0.00376229, 0.00127718, -0.00399919, 0.00320291, -0.00581612], [284.6806, 0.03836039, -0.01457968, 0.0049976, -0.01608092, 0.01301351, -0.01983336], [119.9999, 0.11626756, -0.04571093, 0.01561376, -0.04924864, 0.04021371, -0.07638917], [54.07386, 0.25899831, -0.10593013, 0.03689701, -0.12165679, 0.10150109, -0.1536648], [25.37321, 0.38428226, -0.16836228, 0.05796469, -0.17713367, 0.13700954, -0.28449754], [12.20962, 0.2991121, -0.10373213, 0.03791966, -0.14448197, 0.10628972, 0.10206373], [5.757421, 0.08000672, 0.21083155, -0.11706499, 0.64743311, -0.83390265, 1.55100061], [2.673402, 0.0031944, 0.48916443, -0.20912257, 0.54797692, 0.14412002, -1.84574442], [1.186835, 0.00147252, 0.38468638, -0.05800532, -0.78180321, 0.98301239, 0.10057714], [0.481593, -0.00023391, 0.08529338, 0.16430736, -0.52607778, -0.52956418, 1.39430453], [0.192637, 0.00020761, -0.00161045, 0.52885466, 0.22437177, -0.75303984, -1.12548146], [0.077055, -8.963e-05, 0.0020653, 0.37373016, 0.33392453, 0.442887, -0.18571375], [0.030822, 2.783e-05, -0.00064175, 0.08399866, 0.14446374, 0.57511589, 0.70628395]], [2, [249.3497, 0.00134561, -0.00158359, 0.00191116, -0.00316569], [74.63837, 0.01080983, -0.01281116, 0.01772495, -0.0371074], [28.37641, 0.04733793, -0.05642679, 0.07056381, -0.12591409], [11.94893, 0.13772582, -0.16641393, 0.22906101, -0.49360952], [5.317646, 0.26263833, -0.35106014, 0.43938511, -0.16251663], [2.364417, 0.33470401, -0.2371789, -0.26739908, 1.00715586], [1.012386, 0.31000597, 0.21994641, -0.62590624, -0.32192167], [0.406773, 0.21316819, 0.48841363, 0.1221134, -0.6107269], [0.147331, 0.07865365, 0.29537131, 0.53683629, 0.3903814], [0.058932, 0.00603096, 0.04295539, 0.19750055, 0.37334893]], [3, [15.4333, 0.03682063, -0.06200336, 0.13301012], [6.1172, 0.24591418, -0.52876669, 0.74591931], [2.4246, 0.50112688, -0.29078386, -0.67622545], [0.961, 0.35850648, 0.52124157, -0.31278443], [0.3809, 0.14728062, 0.37532205, 0.60308069], [0.151, 0.02564748, 0.10659798, 0.26056742]], [4, [8.7286, 0.16903848, -0.45244412], [3.4308, 0.60654185, -0.42317767], [1.3485, 0.37979899, 0.61107957], [0.53, 0.10367757, 0.39786263]], [5, [4.2885, 0.69861274], [1.6856, 0.445143741]]], 'O': [[0, [105374.95, 0.00012386, -2.815e-05, 2.616e-05, -5.058e-05, 5.196e-05], [15679.24, 0.00051201, -0.0001163, 0.00010748, -0.00020024, 0.00019612], [3534.5447, 0.00215291, -0.00049092, 0.00045972, -0.00091952, 0.00099303], [987.36516, 0.00852844, -0.00194616, 0.00179555, -0.0032024, 0.00297658], [315.97875, 0.03018049, -0.0070053, 0.00667574, -0.01359974, 0.01564071], [111.65428, 0.09099702, -0.02167814, 0.02053445, -0.03392296, 0.03231923], [42.699451, 0.21779364, -0.05641213, 0.05828602, -0.11685462, 0.16012253], [17.395596, 0.36862457, -0.1127053, 0.12129691, -0.14040275, 0.15386867], [7.438309, 0.33667073, -0.15891197, 0.22641475, -0.47546666, 0.938863], [3.222862, 0.0965763, -0.03355083, -0.042387, 0.83350096, -3.16442722], [1.253877, 0.00214452, 0.35319028, -1.01045538, 1.30186138, 2.94545392], [0.495155, 0.00119435, 0.55341993, -0.15386868, -2.48175844, -0.46724256], [0.191665, 0.00053902, 0.23018391, 0.9934532, 0.81134659, -1.59503813], [0.067083, 0.00021034, 0.01127267, 0.18587254, 0.58210417, 1.34403482]], [1, [200.0, 0.0009173, -0.00087213, 0.00129603, -0.00195602], [46.533367, 0.00737714, -0.00706424, 0.01151279, -0.02399585], [14.621809, 0.03483515, -0.03330489, 0.0515912, -0.09118427], [5.313064, 0.1144397, -0.11441275, 0.20459407, -0.52863388], [2.102525, 0.25549664, -0.29901068, 0.55019345, -0.38198314], [0.850223, 0.37225574, -0.31986054, -0.14872038, 1.44198816], [0.337597, 0.33233149, 0.205509, -0.89690085, -0.67366146], [0.128892, 0.14008479, 0.59359268, 0.24707597, -0.6649695], [0.045112, 0.02395784, 0.28229027, 0.64443405, 0.82977107]], [2, [3.75, 0.13609758, -0.39151953, 0.95199748], [1.3125, 0.51401475, -0.62262728, -0.67736624], [0.459375, 0.47407125, 0.72160073, -0.34608569], [0.160781, 0.08166905, 0.31870103, 0.81524547]], [3, [2.35, 0.33460642, -0.83677707], [0.94, 0.56136672, 0.1072197], [0.376, 0.29572786, 0.72955061]], [4, [1.175, 0.89524901], [0.47, 0.166642351]]]}
ecp = {}
CPU time:         0.28


******** <class 'pyscf.scf.hf_symm.SymAdaptedRHF'> ********
method = SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 500
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = cu2o2_0.8_HF.chk
max_memory 4000 MB (current use 64 MB)
Freeze 0 electrons in irreps []
    72 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 3.16228e-05
init E= -3412.01137386475
HOMO (B3g) = -0.314195721848457  LUMO (B1g) = -0.223421937282817
cycle= 1 E= -3410.87313496054  delta_E= 1.14  |g|= 2.83  |ddm|=  3.4
HOMO (B3g) = -0.939652824298378  LUMO (B1g) = -0.710375641299007
cycle= 2 E= -3410.4353605213  delta_E= 0.438  |g|= 4.29  |ddm|= 2.04
HOMO (B2u) = -0.970357645554632  LUMO (B1g) = -0.601155304273435
cycle= 3 E= -3411.48445499209  delta_E= -1.05  |g|= 0.244  |ddm|= 1.05
HOMO (B2u) = -0.908501170778657  LUMO (B1g) = -0.526656868389402
cycle= 4 E= -3411.48997306226  delta_E= -0.00552  |g|= 0.0382  |ddm|= 0.142
HOMO (B2u) = -0.906697935586372  LUMO (B1g) = -0.527823840667818
cycle= 5 E= -3411.49031357244  delta_E= -0.000341  |g|= 0.0233  |ddm|= 0.0429
HOMO (B2u) = -0.906092317580762  LUMO (B1g) = -0.525594502874474
cycle= 6 E= -3411.49039008058  delta_E= -7.65e-05  |g|= 0.00354  |ddm|= 0.0156
HOMO (B2u) = -0.905617261656901  LUMO (B1g) = -0.525445551292812
cycle= 7 E= -3411.49039645494  delta_E= -6.37e-06  |g|= 0.00195  |ddm|= 0.00643
HOMO (B2u) = -0.905437976098134  LUMO (B1g) = -0.525312870807265
cycle= 8 E= -3411.4903976883  delta_E= -1.23e-06  |g|= 0.000855  |ddm|= 0.00297
HOMO (B2u) = -0.905341580422214  LUMO (B1g) = -0.525276768145811
cycle= 9 E= -3411.49039795259  delta_E= -2.64e-07  |g|= 0.000271  |ddm|= 0.00151
HOMO (B2u) = -0.905282635893165  LUMO (B1g) = -0.525262672918513
cycle= 10 E= -3411.49039799454  delta_E= -4.19e-08  |g|= 5.46e-05  |ddm|= 0.000757
HOMO (B2u) = -0.905271573866583  LUMO (B1g) = -0.525262896213126
cycle= 11 E= -3411.49039799608  delta_E= -1.54e-09  |g|= 2.86e-05  |ddm|= 0.00011
HOMO (B2u) = -0.905269741529864  LUMO (B1g) = -0.525263391040388
cycle= 12 E= -3411.49039799626  delta_E= -1.82e-10  |g|= 6.79e-06  |ddm|= 3.51e-05
HOMO (B2u) = -0.905268995216292  LUMO (B1g) = -0.525263004312753
Extra cycle  E= -3411.49039799628  delta_E= -2.27e-11  |g|= 4.16e-06  |ddm|= 1.2e-05
converged SCF energy = -3411.49039799628
Ag, double-occ = 10, single-occ = 0
B1g, double-occ = 3, single-occ = 0
B2g, double-occ = 3, single-occ = 0
B3g, double-occ = 2, single-occ = 0
Au, double-occ = 1, single-occ = 0
B1u, double-occ = 4, single-occ = 0
B2u, double-occ = 5, single-occ = 0
B3u, double-occ = 8, single-occ = 0
**** SCF Summaries ****
Total Energy =                       -3411.490397996284173
Nuclear Repulsion Energy =             410.257942611815167
One-electron Energy =                -5553.976128571964182
Two-electron Energy =                 1732.227787963865239
Wave-function symmetry = Ag
occupancy for each irrep:     Ag  B1g  B2g  B3g   Au  B1u  B2u  B3u
                              10    3    3    2    1    4    5    8
**** MO energy ****
MO #1 (B3u #1), energy= -325.615434509427 occ= 2
MO #2 (Ag #1), energy= -325.615192879501 occ= 2
MO #3 (B3u #2), energy= -40.9554932991573 occ= 2
MO #4 (Ag #2), energy= -40.9551922141465 occ= 2
MO #5 (B2u #1), energy= -36.1314601769002 occ= 2
MO #6 (B1g #1), energy= -36.1314598635592 occ= 2
MO #7 (B3u #3), energy= -36.1295310079225 occ= 2
MO #8 (Ag #3), energy= -36.1294767735176 occ= 2
MO #9 (B2g #1), energy= -36.122345429898 occ= 2
MO #10 (B1u #1), energy= -36.1223126887754 occ= 2
MO #11 (Ag #4), energy= -21.1595704140476 occ= 2
MO #12 (B2u #2), energy= -21.1592796083744 occ= 2
MO #13 (B3u #4), energy= -5.51425611254232 occ= 2
MO #14 (Ag #5), energy= -5.51416879180925 occ= 2
MO #15 (Ag #6), energy= -3.8896571457766 occ= 2
MO #16 (B3u #5), energy= -3.88954243131996 occ= 2
MO #17 (B2u #3), energy= -3.88656682627193 occ= 2
MO #18 (B1g #2), energy= -3.88635554588669 occ= 2
MO #19 (B2g #2), energy= -3.88010107364719 occ= 2
MO #20 (B1u #2), energy= -3.88008094273343 occ= 2
MO #21 (Ag #7), energy= -1.89544125270866 occ= 2
MO #22 (B2u #4), energy= -1.64890672531477 occ= 2
MO #23 (B1u #3), energy= -1.14491046254769 occ= 2
MO #24 (B3u #6), energy= -1.13848762507239 occ= 2
MO #25 (Ag #8), energy= -1.11395288749345 occ= 2
MO #26 (B3u #7), energy= -1.07034039997606 occ= 2
MO #27 (B3g #1), energy= -1.06953355175524 occ= 2
MO #28 (B2g #3), energy= -1.06383029344238 occ= 2
MO #29 (Au #1), energy= -1.06187391876909 occ= 2
MO #30 (Ag #9), energy= -1.05274053854716 occ= 2
MO #31 (B1g #3), energy= -1.03528349467425 occ= 2
MO #32 (B1u #4), energy= -1.02494399900939 occ= 2
MO #33 (Ag #10), energy= -1.0086073958605 occ= 2
MO #34 (B3u #8), energy= -0.988945745947739 occ= 2
MO #35 (B3g #2), energy= -0.969697885297396 occ= 2
MO #36 (B2u #5), energy= -0.905268995216292 occ= 2
MO #37 (B1g #4), energy= -0.525263004312753 occ= 0
MO #38 (Ag #11), energy= -0.352229501985873 occ= 0
MO #39 (B3u #9), energy= -0.324819886137122 occ= 0
MO #40 (B2u #6), energy= -0.32178440352954 occ= 0
MO #41 (B1u #5), energy= -0.237401979534878 occ= 0
MO #42 (B2g #4), energy= -0.227071713739635 occ= 0
MO #43 (B2u #7), energy= -0.217953769292794 occ= 0
MO #44 (Ag #12), energy= -0.190169669991694 occ= 0
MO #45 (B1g #5), energy= -0.18659548973052 occ= 0
MO #46 (Ag #13), energy= -0.150659238062989 occ= 0
MO #47 (B3u #10), energy= -0.132915094826775 occ= 0
MO #48 (Ag #14), energy= -0.0672002081465991 occ= 0
MO #49 (B3u #11), energy= -0.0655661812461444 occ= 0
MO #50 (B3g #3), energy= -0.0540866546141223 occ= 0
MO #51 (B2u #8), energy= -0.0456117759703802 occ= 0
MO #52 (B1u #6), energy= -0.0210079708888071 occ= 0
MO #53 (B3u #12), energy= 0.0796229612174435 occ= 0
MO #54 (B1u #7), energy= 0.0894260056544925 occ= 0
MO #55 (B2g #5), energy= 0.100272068366958 occ= 0
MO #56 (B2u #9), energy= 0.113570156607439 occ= 0
MO #57 (B1g #6), energy= 0.154666177296539 occ= 0
MO #58 (Ag #15), energy= 0.165101219679994 occ= 0
MO #59 (Au #2), energy= 0.170333572140336 occ= 0
MO #60 (B1g #7), energy= 0.18461234069847 occ= 0
MO #61 (Ag #16), energy= 0.226264079759028 occ= 0
MO #62 (B3u #13), energy= 0.290503452540562 occ= 0
MO #63 (B2g #6), energy= 0.30238935979053 occ= 0
MO #64 (B3g #4), energy= 0.362104588698459 occ= 0
MO #65 (Ag #17), energy= 0.364619212956651 occ= 0
MO #66 (B1u #8), energy= 0.406296841287041 occ= 0
MO #67 (B3u #14), energy= 0.407193627211928 occ= 0
MO #68 (Ag #18), energy= 0.411969924943656 occ= 0
MO #69 (B2u #10), energy= 0.434336833369881 occ= 0
MO #70 (B2u #11), energy= 0.603113157930504 occ= 0
MO #71 (B3u #15), energy= 0.614916212412281 occ= 0
MO #72 (B1u #9), energy= 0.676509621914373 occ= 0
MO #73 (B3u #16), energy= 0.701541341454652 occ= 0
MO #74 (Ag #19), energy= 0.708540335047312 occ= 0
MO #75 (Ag #20), energy= 0.755427603440745 occ= 0
MO #76 (Au #3), energy= 0.764196744036513 occ= 0
MO #77 (B2u #12), energy= 0.778007636582365 occ= 0
MO #78 (B2g #7), energy= 0.85798053808646 occ= 0
MO #79 (B3g #5), energy= 0.858489101769601 occ= 0
MO #80 (B1g #8), energy= 0.860886760653644 occ= 0
MO #81 (B1u #10), energy= 0.925540280011987 occ= 0
MO #82 (Ag #21), energy= 1.04962702858399 occ= 0
MO #83 (B1g #9), energy= 1.08847210094375 occ= 0
MO #84 (B3g #6), energy= 1.16440400601035 occ= 0
MO #85 (B2g #8), energy= 1.19140109689121 occ= 0
MO #86 (B2u #13), energy= 1.21528414536616 occ= 0
MO #87 (B3u #17), energy= 1.25409848822083 occ= 0
MO #88 (B1u #11), energy= 1.30131256295307 occ= 0
MO #89 (B1g #10), energy= 1.3460368358993 occ= 0
MO #90 (B2u #14), energy= 1.38956276167333 occ= 0
MO #91 (Ag #22), energy= 1.50592176239531 occ= 0
MO #92 (B1g #11), energy= 1.53293211176713 occ= 0
MO #93 (Ag #23), energy= 1.55898931601959 occ= 0
MO #94 (B3g #7), energy= 1.58675153214046 occ= 0
MO #95 (B3u #18), energy= 1.58859699853547 occ= 0
MO #96 (B1u #12), energy= 1.60787183823475 occ= 0
MO #97 (B2g #9), energy= 1.67465716677531 occ= 0
MO #98 (B3u #19), energy= 1.80397931822557 occ= 0
MO #99 (B1u #13), energy= 1.86694259030699 occ= 0
MO #100 (Au #4), energy= 1.88315181222083 occ= 0
MO #101 (B3u #20), energy= 2.00619180551501 occ= 0
MO #102 (B2u #15), energy= 2.03049073143452 occ= 0
MO #103 (Ag #24), energy= 2.05216595079809 occ= 0
MO #104 (B1g #12), energy= 2.10562278350377 occ= 0
MO #105 (Au #5), energy= 2.23254477233353 occ= 0
MO #106 (Ag #25), energy= 2.25759970531699 occ= 0
MO #107 (B2g #10), energy= 2.32349785784658 occ= 0
MO #108 (Ag #26), energy= 2.33498546998784 occ= 0
MO #109 (B2u #16), energy= 2.3720411009988 occ= 0
MO #110 (B1u #14), energy= 2.43194613081318 occ= 0
MO #111 (B2g #11), energy= 2.49076474850032 occ= 0
MO #112 (B2u #17), energy= 2.51569334722031 occ= 0
MO #113 (B3u #21), energy= 2.57919815555145 occ= 0
MO #114 (B3g #8), energy= 2.62829456449464 occ= 0
MO #115 (Au #6), energy= 2.63379051646758 occ= 0
MO #116 (B1g #13), energy= 2.64671445896214 occ= 0
MO #117 (Ag #27), energy= 2.64864678956257 occ= 0
MO #118 (B1u #15), energy= 2.70836887866536 occ= 0
MO #119 (B3u #22), energy= 2.71256590742195 occ= 0
MO #120 (B2u #18), energy= 2.71256846075669 occ= 0
MO #121 (Ag #28), energy= 2.76672822431839 occ= 0
MO #122 (B3g #9), energy= 2.84652180734847 occ= 0
MO #123 (B2g #12), energy= 2.84972120043574 occ= 0
MO #124 (B2u #19), energy= 2.98485063790272 occ= 0
MO #125 (B3g #10), energy= 3.06235146776053 occ= 0
MO #126 (B1u #16), energy= 3.06459251253782 occ= 0
MO #127 (B1g #14), energy= 3.10380708028296 occ= 0
MO #128 (B3u #23), energy= 3.14614015959028 occ= 0
MO #129 (B2u #20), energy= 3.31783797447238 occ= 0
MO #130 (Ag #29), energy= 3.32242368078704 occ= 0
MO #131 (B1u #17), energy= 3.35280341400914 occ= 0
MO #132 (B3u #24), energy= 3.46302189231377 occ= 0
MO #133 (Ag #30), energy= 3.50166536754072 occ= 0
MO #134 (Au #7), energy= 3.57928324497706 occ= 0
MO #135 (B2u #21), energy= 3.58863564525373 occ= 0
MO #136 (B1g #15), energy= 3.60941185381645 occ= 0
MO #137 (Ag #31), energy= 3.63436169473206 occ= 0
MO #138 (B2g #13), energy= 3.65377710314303 occ= 0
MO #139 (B3u #25), energy= 3.70781605831716 occ= 0
MO #140 (B3g #11), energy= 3.83305600083537 occ= 0
MO #141 (B1g #16), energy= 3.88155775440993 occ= 0
MO #142 (B3u #26), energy= 4.14641088874587 occ= 0
MO #143 (B1g #17), energy= 4.18283021896835 occ= 0
MO #144 (Ag #32), energy= 4.24038337460116 occ= 0
MO #145 (B2u #22), energy= 4.30192168933672 occ= 0
MO #146 (B1u #18), energy= 4.58427180715136 occ= 0
MO #147 (B2g #14), energy= 4.64359021171046 occ= 0
MO #148 (Ag #33), energy= 4.66157170914584 occ= 0
MO #149 (B3u #27), energy= 4.77100061180065 occ= 0
MO #150 (B2u #23), energy= 4.82736481406171 occ= 0
MO #151 (Ag #34), energy= 4.83859253366438 occ= 0
MO #152 (B1u #19), energy= 4.88850760988098 occ= 0
MO #153 (B2g #15), energy= 4.92181381570526 occ= 0
MO #154 (Au #8), energy= 4.96951832118682 occ= 0
MO #155 (B3g #12), energy= 5.07848559943601 occ= 0
MO #156 (B3g #13), energy= 5.13965576410709 occ= 0
MO #157 (B3u #28), energy= 5.18455623628077 occ= 0
MO #158 (B1g #18), energy= 5.1939477503523 occ= 0
MO #159 (Ag #35), energy= 5.21926629410194 occ= 0
MO #160 (B1u #20), energy= 5.23245136571867 occ= 0
MO #161 (B2u #24), energy= 5.28770460904369 occ= 0
MO #162 (B1u #21), energy= 5.40125166750017 occ= 0
MO #163 (B1g #19), energy= 5.40308930713126 occ= 0
MO #164 (B2g #16), energy= 5.41439865127311 occ= 0
MO #165 (B2u #25), energy= 5.44401269602883 occ= 0
MO #166 (B3u #29), energy= 5.50231179890072 occ= 0
MO #167 (Ag #36), energy= 5.50639183333565 occ= 0
MO #168 (Au #9), energy= 5.51083355442038 occ= 0
MO #169 (B3g #14), energy= 5.53934612942362 occ= 0
MO #170 (Ag #37), energy= 5.64634704681635 occ= 0
MO #171 (B1u #22), energy= 5.65570157222259 occ= 0
MO #172 (Au #10), energy= 5.68827676183823 occ= 0
MO #173 (B2g #17), energy= 5.70950801712077 occ= 0
MO #174 (B3u #30), energy= 5.71726038112258 occ= 0
MO #175 (B2u #26), energy= 5.73570775232554 occ= 0
MO #176 (B1g #20), energy= 5.83322431400987 occ= 0
MO #177 (Ag #38), energy= 5.84967345413456 occ= 0
MO #178 (B3g #15), energy= 5.86751306108985 occ= 0
MO #179 (B1u #23), energy= 5.88788243580496 occ= 0
MO #180 (B3u #31), energy= 5.91096865458043 occ= 0
MO #181 (B2g #18), energy= 6.02205888200643 occ= 0
MO #182 (Ag #39), energy= 6.05249034225182 occ= 0
MO #183 (Au #11), energy= 6.16936881917632 occ= 0
MO #184 (B2u #27), energy= 6.19987767385108 occ= 0
MO #185 (B1g #21), energy= 6.26150477105958 occ= 0
MO #186 (B3u #32), energy= 6.31229660733954 occ= 0
MO #187 (B2u #28), energy= 6.36867829687125 occ= 0
MO #188 (Ag #40), energy= 6.59727883612602 occ= 0
MO #189 (B3g #16), energy= 6.64709457766036 occ= 0
MO #190 (B1g #22), energy= 6.68704806341707 occ= 0
MO #191 (B3u #33), energy= 6.79193159491089 occ= 0
MO #192 (B2u #29), energy= 6.90857371690991 occ= 0
MO #193 (B2g #19), energy= 6.94166838507538 occ= 0
MO #194 (Au #12), energy= 6.94458408932919 occ= 0
MO #195 (B3g #17), energy= 7.01705391714323 occ= 0
MO #196 (B1u #24), energy= 7.05087770446656 occ= 0
MO #197 (B1g #23), energy= 7.20220203327674 occ= 0
MO #198 (Ag #41), energy= 7.31299039857312 occ= 0
MO #199 (Ag #42), energy= 7.79584873291236 occ= 0
MO #200 (B2u #30), energy= 7.91406084197986 occ= 0
MO #201 (B3u #34), energy= 7.93199261602514 occ= 0
MO #202 (B2u #31), energy= 8.00722716951329 occ= 0
MO #203 (B1u #25), energy= 8.02046016902942 occ= 0
MO #204 (B2g #20), energy= 8.09212521104684 occ= 0
MO #205 (B1g #24), energy= 8.13523391289219 occ= 0
MO #206 (B3u #35), energy= 8.19431820930001 occ= 0
MO #207 (Au #13), energy= 8.52531624665474 occ= 0
MO #208 (Ag #43), energy= 8.64476515275661 occ= 0
MO #209 (B1u #26), energy= 8.7032871444555 occ= 0
MO #210 (B3g #18), energy= 8.79651777870077 occ= 0
MO #211 (Ag #44), energy= 9.01590319966479 occ= 0
MO #212 (B2u #32), energy= 9.02229979324059 occ= 0
MO #213 (B3u #36), energy= 9.26179826835222 occ= 0
MO #214 (B3u #37), energy= 9.51236824563066 occ= 0
MO #215 (B3g #19), energy= 9.51245876018023 occ= 0
MO #216 (B1g #25), energy= 9.59656026046661 occ= 0
MO #217 (B2u #33), energy= 9.60698630942471 occ= 0
MO #218 (B1u #27), energy= 9.66983244155654 occ= 0
MO #219 (Ag #45), energy= 10.0184049258218 occ= 0
MO #220 (B2u #34), energy= 10.0864533306839 occ= 0
MO #221 (B1g #26), energy= 10.0985171522961 occ= 0
MO #222 (Au #14), energy= 10.2825224856595 occ= 0
MO #223 (B2g #21), energy= 10.5187809806211 occ= 0
MO #224 (Au #15), energy= 10.7139972176069 occ= 0
MO #225 (B3u #38), energy= 10.7462724912029 occ= 0
MO #226 (Ag #46), energy= 10.8462254924906 occ= 0
MO #227 (B3g #20), energy= 10.9096674649644 occ= 0
MO #228 (Ag #47), energy= 11.077865045132 occ= 0
MO #229 (B3g #21), energy= 11.1214980639943 occ= 0
MO #230 (B2u #35), energy= 11.2927718641875 occ= 0
MO #231 (B2g #22), energy= 11.3365020882616 occ= 0
MO #232 (B3u #39), energy= 11.715033058668 occ= 0
MO #233 (Ag #48), energy= 11.785415224283 occ= 0
MO #234 (B1u #28), energy= 11.8717367726406 occ= 0
MO #235 (B1u #29), energy= 12.1180616466168 occ= 0
MO #236 (B1g #27), energy= 12.1789914592411 occ= 0
MO #237 (B2u #36), energy= 12.3030870604148 occ= 0
MO #238 (Ag #49), energy= 12.4030973119834 occ= 0
MO #239 (B2g #23), energy= 12.5527107398875 occ= 0
MO #240 (B1g #28), energy= 12.6820190681472 occ= 0
MO #241 (B2u #37), energy= 12.8559997273981 occ= 0
MO #242 (B3u #40), energy= 13.2804141745029 occ= 0
MO #243 (B1g #29), energy= 13.4017413317623 occ= 0
MO #244 (B2u #38), energy= 13.6450788483759 occ= 0
MO #245 (Ag #50), energy= 13.8722975298648 occ= 0
MO #246 (B3u #41), energy= 14.1674148236846 occ= 0
MO #247 (B2g #24), energy= 16.5386970258755 occ= 0
MO #248 (B1u #30), energy= 16.5854150780888 occ= 0
MO #249 (B1g #30), energy= 16.599706393774 occ= 0
MO #250 (B2u #39), energy= 16.6323780097493 occ= 0
MO #251 (B3u #42), energy= 16.9567725380975 occ= 0
MO #252 (B3g #22), energy= 16.9589187170654 occ= 0
MO #253 (Ag #51), energy= 16.9589990248749 occ= 0
MO #254 (Au #16), energy= 16.9608270044781 occ= 0
MO #255 (B1u #31), energy= 16.9620023670424 occ= 0
MO #256 (B2g #25), energy= 16.9620937796626 occ= 0
MO #257 (B1g #31), energy= 16.9636902069954 occ= 0
MO #258 (B2u #40), energy= 16.9640105132322 occ= 0
MO #259 (B1u #32), energy= 16.9658957646626 occ= 0
MO #260 (B2g #26), energy= 16.9686253795992 occ= 0
MO #261 (B2g #27), energy= 16.9799575772486 occ= 0
MO #262 (B3u #43), energy= 16.9802386146507 occ= 0
MO #263 (B1u #33), energy= 16.9842796905659 occ= 0
MO #264 (B3g #23), energy= 16.9844086151427 occ= 0
MO #265 (Au #17), energy= 16.9857847802189 occ= 0
MO #266 (Ag #52), energy= 16.9864077440048 occ= 0
MO #267 (B3u #44), energy= 16.9873834652751 occ= 0
MO #268 (B1g #32), energy= 16.9947949090144 occ= 0
MO #269 (B2u #41), energy= 16.9968497098239 occ= 0
MO #270 (Ag #53), energy= 17.0137350503961 occ= 0
MO #271 (B2u #42), energy= 17.0500801513565 occ= 0
MO #272 (B1g #33), energy= 17.0841329621857 occ= 0
MO #273 (B3g #24), energy= 17.347154393298 occ= 0
MO #274 (Au #18), energy= 17.4315592158879 occ= 0
MO #275 (Ag #54), energy= 17.5432007712521 occ= 0
MO #276 (B3u #45), energy= 17.5534537778254 occ= 0
MO #277 (B2g #28), energy= 17.7264950014992 occ= 0
MO #278 (B1u #34), energy= 17.8665439654761 occ= 0
MO #279 (Ag #55), energy= 18.1969600588833 occ= 0
MO #280 (B2u #43), energy= 18.5535739287535 occ= 0
MO #281 (B3u #46), energy= 18.6795250682389 occ= 0
MO #282 (B1g #34), energy= 18.6842857532063 occ= 0
MO #283 (B3u #47), energy= 19.6063923813147 occ= 0
MO #284 (Ag #56), energy= 19.609329224259 occ= 0
MO #285 (Au #19), energy= 19.6114643322507 occ= 0
MO #286 (B3g #25), energy= 19.6134437110093 occ= 0
MO #287 (B2g #29), energy= 19.8774114997849 occ= 0
MO #288 (B1u #35), energy= 19.8899089838584 occ= 0
MO #289 (B2u #44), energy= 20.0322049950659 occ= 0
MO #290 (B1g #35), energy= 20.1441537083086 occ= 0
MO #291 (Ag #57), energy= 20.4151705325133 occ= 0
MO #292 (Au #20), energy= 20.7167932736944 occ= 0
MO #293 (B2g #30), energy= 20.7363708192983 occ= 0
MO #294 (B3g #26), energy= 20.7427687901792 occ= 0
MO #295 (B1u #36), energy= 20.7657852015703 occ= 0
MO #296 (B3u #48), energy= 21.0472921382944 occ= 0
MO #297 (Ag #58), energy= 21.0547523838723 occ= 0
MO #298 (B3u #49), energy= 21.5425550259072 occ= 0
MO #299 (B2u #45), energy= 21.8716115160923 occ= 0
MO #300 (B1g #36), energy= 22.3743070815143 occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0 Cu 1s        1.99993
pop of  0 Cu 2s        1.99940
pop of  0 Cu 3s        1.99793
pop of  0 Cu 4s        0.11752
pop of  0 Cu 5s        0.00157
pop of  0 Cu 6s        0.00182
pop of  0 Cu 7s        0.00150
pop of  0 Cu 2px       1.99991
pop of  0 Cu 2py       1.99992
pop of  0 Cu 2pz       1.99992
pop of  0 Cu 3px       1.99977
pop of  0 Cu 3py       1.99967
pop of  0 Cu 3pz       1.99971
pop of  0 Cu 4px       0.00262
pop of  0 Cu 4py       0.00135
pop of  0 Cu 4pz       0.00015
pop of  0 Cu 5px       0.00072
pop of  0 Cu 5py       0.00043
pop of  0 Cu 5pz       0.00047
pop of  0 Cu 6px       0.00034
pop of  0 Cu 6py       0.00035
pop of  0 Cu 6pz       0.00051
pop of  0 Cu 7px       0.00027
pop of  0 Cu 7py       0.00007
pop of  0 Cu 7pz       0.00011
pop of  0 Cu 3dxy      1.63868
pop of  0 Cu 3dyz      1.99704
pop of  0 Cu 3dz^2     1.99282
pop of  0 Cu 3dxz      1.99679
pop of  0 Cu 3dx2-y2    1.99335
pop of  0 Cu 4dxy      0.00025
pop of  0 Cu 4dyz      0.00147
pop of  0 Cu 4dz^2     0.00097
pop of  0 Cu 4dxz      0.00107
pop of  0 Cu 4dx2-y2    0.00131
pop of  0 Cu 5dxy      0.00065
pop of  0 Cu 5dyz      0.00098
pop of  0 Cu 5dz^2     0.00087
pop of  0 Cu 5dxz      0.00094
pop of  0 Cu 5dx2-y2    0.00072
pop of  0 Cu 6dxy      0.00029
pop of  0 Cu 6dyz      0.00010
pop of  0 Cu 6dz^2     0.00016
pop of  0 Cu 6dxz      0.00029
pop of  0 Cu 6dx2-y2    0.00015
pop of  0 Cu 4fy^3     0.00011
pop of  0 Cu 4fxyz     0.00006
pop of  0 Cu 4fyz^2    0.00001
pop of  0 Cu 4fz^3     0.00003
pop of  0 Cu 4fxz^2    0.00005
pop of  0 Cu 4fzx^2    0.00002
pop of  0 Cu 4fx^3     0.00011
pop of  0 Cu 5fy^3     0.00007
pop of  0 Cu 5fxyz     0.00007
pop of  0 Cu 5fyz^2    0.00001
pop of  0 Cu 5fz^3     0.00003
pop of  0 Cu 5fxz^2    0.00007
pop of  0 Cu 5fzx^2    0.00004
pop of  0 Cu 5fx^3     0.00017
pop of  0 Cu 6fy^3     0.00001
pop of  0 Cu 6fxyz     0.00002
pop of  0 Cu 6fyz^2    0.00000
pop of  0 Cu 6fz^3     0.00002
pop of  0 Cu 6fxz^2    0.00012
pop of  0 Cu 6fzx^2    0.00003
pop of  0 Cu 6fx^3     0.00011
pop of  0 Cu 5g-4      0.00000
pop of  0 Cu 5g-3      0.00000
pop of  0 Cu 5g-2      0.00000
pop of  0 Cu 5g-1      0.00000
pop of  0 Cu 5g 0      0.00001
pop of  0 Cu 5g 1      0.00001
pop of  0 Cu 5g 2      0.00001
pop of  0 Cu 5g 3      0.00000
pop of  0 Cu 5g 4      0.00001
pop of  0 Cu 6g-4      0.00001
pop of  0 Cu 6g-3      0.00001
pop of  0 Cu 6g-2      0.00000
pop of  0 Cu 6g-1      0.00000
pop of  0 Cu 6g 0      0.00001
pop of  0 Cu 6g 1      0.00001
pop of  0 Cu 6g 2      0.00002
pop of  0 Cu 6g 3      0.00001
pop of  0 Cu 6g 4      0.00006
pop of  0 Cu 6h-5      0.00000
pop of  0 Cu 6h-4      0.00000
pop of  0 Cu 6h-3      0.00000
pop of  0 Cu 6h-2      0.00000
pop of  0 Cu 6h-1      0.00000
pop of  0 Cu 6h 0      0.00000
pop of  0 Cu 6h 1      0.00000
pop of  0 Cu 6h 2      0.00000
pop of  0 Cu 6h 3      0.00000
pop of  0 Cu 6h 4      0.00000
pop of  0 Cu 6h 5      0.00000
pop of  1 Cu 1s        1.99993
pop of  1 Cu 2s        1.99940
pop of  1 Cu 3s        1.99793
pop of  1 Cu 4s        0.11752
pop of  1 Cu 5s        0.00157
pop of  1 Cu 6s        0.00182
pop of  1 Cu 7s        0.00150
pop of  1 Cu 2px       1.99991
pop of  1 Cu 2py       1.99992
pop of  1 Cu 2pz       1.99992
pop of  1 Cu 3px       1.99977
pop of  1 Cu 3py       1.99967
pop of  1 Cu 3pz       1.99971
pop of  1 Cu 4px       0.00262
pop of  1 Cu 4py       0.00135
pop of  1 Cu 4pz       0.00015
pop of  1 Cu 5px       0.00072
pop of  1 Cu 5py       0.00043
pop of  1 Cu 5pz       0.00047
pop of  1 Cu 6px       0.00034
pop of  1 Cu 6py       0.00035
pop of  1 Cu 6pz       0.00051
pop of  1 Cu 7px       0.00027
pop of  1 Cu 7py       0.00007
pop of  1 Cu 7pz       0.00011
pop of  1 Cu 3dxy      1.63868
pop of  1 Cu 3dyz      1.99704
pop of  1 Cu 3dz^2     1.99282
pop of  1 Cu 3dxz      1.99679
pop of  1 Cu 3dx2-y2    1.99335
pop of  1 Cu 4dxy      0.00025
pop of  1 Cu 4dyz      0.00147
pop of  1 Cu 4dz^2     0.00097
pop of  1 Cu 4dxz      0.00107
pop of  1 Cu 4dx2-y2    0.00131
pop of  1 Cu 5dxy      0.00065
pop of  1 Cu 5dyz      0.00098
pop of  1 Cu 5dz^2     0.00087
pop of  1 Cu 5dxz      0.00094
pop of  1 Cu 5dx2-y2    0.00072
pop of  1 Cu 6dxy      0.00029
pop of  1 Cu 6dyz      0.00010
pop of  1 Cu 6dz^2     0.00016
pop of  1 Cu 6dxz      0.00029
pop of  1 Cu 6dx2-y2    0.00015
pop of  1 Cu 4fy^3     0.00011
pop of  1 Cu 4fxyz     0.00006
pop of  1 Cu 4fyz^2    0.00001
pop of  1 Cu 4fz^3     0.00003
pop of  1 Cu 4fxz^2    0.00005
pop of  1 Cu 4fzx^2    0.00002
pop of  1 Cu 4fx^3     0.00011
pop of  1 Cu 5fy^3     0.00007
pop of  1 Cu 5fxyz     0.00007
pop of  1 Cu 5fyz^2    0.00001
pop of  1 Cu 5fz^3     0.00003
pop of  1 Cu 5fxz^2    0.00007
pop of  1 Cu 5fzx^2    0.00004
pop of  1 Cu 5fx^3     0.00017
pop of  1 Cu 6fy^3     0.00001
pop of  1 Cu 6fxyz     0.00002
pop of  1 Cu 6fyz^2    0.00000
pop of  1 Cu 6fz^3     0.00002
pop of  1 Cu 6fxz^2    0.00012
pop of  1 Cu 6fzx^2    0.00003
pop of  1 Cu 6fx^3     0.00011
pop of  1 Cu 5g-4      0.00000
pop of  1 Cu 5g-3      0.00000
pop of  1 Cu 5g-2      0.00000
pop of  1 Cu 5g-1      0.00000
pop of  1 Cu 5g 0      0.00001
pop of  1 Cu 5g 1      0.00001
pop of  1 Cu 5g 2      0.00001
pop of  1 Cu 5g 3      0.00000
pop of  1 Cu 5g 4      0.00001
pop of  1 Cu 6g-4      0.00001
pop of  1 Cu 6g-3      0.00001
pop of  1 Cu 6g-2      0.00000
pop of  1 Cu 6g-1      0.00000
pop of  1 Cu 6g 0      0.00001
pop of  1 Cu 6g 1      0.00001
pop of  1 Cu 6g 2      0.00002
pop of  1 Cu 6g 3      0.00001
pop of  1 Cu 6g 4      0.00006
pop of  1 Cu 6h-5      0.00000
pop of  1 Cu 6h-4      0.00000
pop of  1 Cu 6h-3      0.00000
pop of  1 Cu 6h-2      0.00000
pop of  1 Cu 6h-1      0.00000
pop of  1 Cu 6h 0      0.00000
pop of  1 Cu 6h 1      0.00000
pop of  1 Cu 6h 2      0.00000
pop of  1 Cu 6h 3      0.00000
pop of  1 Cu 6h 4      0.00000
pop of  1 Cu 6h 5      0.00000
pop of  2 O 1s        1.99999
pop of  2 O 2s        1.87933
pop of  2 O 3s        0.00074
pop of  2 O 4s        0.00016
pop of  2 O 5s        0.00018
pop of  2 O 2px       1.27353
pop of  2 O 2py       1.06704
pop of  2 O 2pz       1.99441
pop of  2 O 3px       0.00133
pop of  2 O 3py       0.00112
pop of  2 O 3pz       0.00189
pop of  2 O 4px       0.00382
pop of  2 O 4py       0.00103
pop of  2 O 4pz       0.00081
pop of  2 O 5px       0.00086
pop of  2 O 5py       0.00007
pop of  2 O 5pz       0.00015
pop of  2 O 3dxy      0.00470
pop of  2 O 3dyz      0.00149
pop of  2 O 3dz^2     0.00216
pop of  2 O 3dxz      0.00003
pop of  2 O 3dx2-y2    0.00338
pop of  2 O 4dxy      0.00146
pop of  2 O 4dyz      0.00031
pop of  2 O 4dz^2     0.00042
pop of  2 O 4dxz      0.00007
pop of  2 O 4dx2-y2    0.00026
pop of  2 O 5dxy      0.00024
pop of  2 O 5dyz      0.00008
pop of  2 O 5dz^2     0.00008
pop of  2 O 5dxz      0.00007
pop of  2 O 5dx2-y2    0.00010
pop of  2 O 4fy^3     0.00002
pop of  2 O 4fxyz     0.00000
pop of  2 O 4fyz^2    0.00030
pop of  2 O 4fz^3     0.00039
pop of  2 O 4fxz^2    0.00036
pop of  2 O 4fzx^2    0.00012
pop of  2 O 4fx^3     0.00035
pop of  2 O 5fy^3     0.00014
pop of  2 O 5fxyz     0.00000
pop of  2 O 5fyz^2    0.00007
pop of  2 O 5fz^3     0.00012
pop of  2 O 5fxz^2    0.00009
pop of  2 O 5fzx^2    0.00009
pop of  2 O 5fx^3     0.00027
pop of  2 O 5g-4      0.00003
pop of  2 O 5g-3      0.00001
pop of  2 O 5g-2      0.00001
pop of  2 O 5g-1      0.00003
pop of  2 O 5g 0      0.00002
pop of  2 O 5g 1      0.00000
pop of  2 O 5g 2      0.00002
pop of  2 O 5g 3      0.00000
pop of  2 O 5g 4      0.00004
pop of  3 O 1s        1.99999
pop of  3 O 2s        1.87933
pop of  3 O 3s        0.00074
pop of  3 O 4s        0.00016
pop of  3 O 5s        0.00018
pop of  3 O 2px       1.27353
pop of  3 O 2py       1.06704
pop of  3 O 2pz       1.99441
pop of  3 O 3px       0.00133
pop of  3 O 3py       0.00112
pop of  3 O 3pz       0.00189
pop of  3 O 4px       0.00382
pop of  3 O 4py       0.00103
pop of  3 O 4pz       0.00081
pop of  3 O 5px       0.00086
pop of  3 O 5py       0.00007
pop of  3 O 5pz       0.00015
pop of  3 O 3dxy      0.00470
pop of  3 O 3dyz      0.00149
pop of  3 O 3dz^2     0.00216
pop of  3 O 3dxz      0.00003
pop of  3 O 3dx2-y2    0.00338
pop of  3 O 4dxy      0.00146
pop of  3 O 4dyz      0.00031
pop of  3 O 4dz^2     0.00042
pop of  3 O 4dxz      0.00007
pop of  3 O 4dx2-y2    0.00026
pop of  3 O 5dxy      0.00024
pop of  3 O 5dyz      0.00008
pop of  3 O 5dz^2     0.00008
pop of  3 O 5dxz      0.00007
pop of  3 O 5dx2-y2    0.00010
pop of  3 O 4fy^3     0.00002
pop of  3 O 4fxyz     0.00000
pop of  3 O 4fyz^2    0.00030
pop of  3 O 4fz^3     0.00039
pop of  3 O 4fxz^2    0.00036
pop of  3 O 4fzx^2    0.00012
pop of  3 O 4fx^3     0.00035
pop of  3 O 5fy^3     0.00014
pop of  3 O 5fxyz     0.00000
pop of  3 O 5fyz^2    0.00007
pop of  3 O 5fz^3     0.00012
pop of  3 O 5fxz^2    0.00009
pop of  3 O 5fzx^2    0.00009
pop of  3 O 5fx^3     0.00027
pop of  3 O 5g-4      0.00003
pop of  3 O 5g-3      0.00001
pop of  3 O 5g-2      0.00001
pop of  3 O 5g-1      0.00003
pop of  3 O 5g 0      0.00002
pop of  3 O 5g 1      0.00000
pop of  3 O 5g 2      0.00002
pop of  3 O 5g 3      0.00000
pop of  3 O 5g 4      0.00004
 ** Mulliken atomic charges  **
charge of  0Cu =      1.24382
charge of  1Cu =      1.24382
charge of  2O =     -0.24382
charge of  3O =     -0.24382
Dipole moment(X, Y, Z, Debye):  0.00000, -0.00000,  0.00000
ncore for each irreps {'B1g': 2, 'Ag': 7, 'B3u': 5, 'B2u': 4, 'B1u': 2, 'Au': 0, 'B2g': 2, 'B3g': 0}
ncas for each irreps {'B1g': 4, 'Ag': 6, 'B3u': 6, 'B2u': 4, 'B1u': 4, 'Au': 2, 'B2g': 2, 'B3g': 4}
(0-based) caslst = [22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45
 46 48 49 50 51 56 58 63]

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (14e+14e, 32o), ncore = 22, nvir = 246
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = cu2o2_0.8_SHCISCF.chk
max_memory 4000 MB (current use 454 MB)
internal_rotation = False

******** SHCI flags ********
executable             = /home/nsb37/Dice_github/Dice
mpiprefix              = mpirun
scratchDirectory       = /scratch/nsb37/161410/TMPDIR/54123
integralFile           = ./FCIDUMP
configFile             = ./input.dat
outputFile             = ./output.dat
maxIter                = 6
sweep_iter             = [    0,    3,    6]
sweep_epsilon          = [0.001,0.0005,0.0001]
nPTiter                = 0
Stochastic             = True
restart                = False
fullrestart            = False
num_thrds              = 1
memory                 = None

Active space CI wfn symmetry = Ag
CASCI E = -3411.73308695097  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -3411.88537193246  dE = -0.15228498  S^2 = 0.0000000
               |grad[o]|=0.417  |grad[c]|= None  |ddm|=0.265
macro iter 2 (21 JK  4 micro), CASSCF E = -3412.01144575954  dE = -0.12607383  S^2 = 0.0000000
               |grad[o]|=0.202  |grad[c]|= None  |ddm|=0.0648
macro iter 3 (21 JK  4 micro), CASSCF E = -3412.10167013965  dE = -0.09022438  S^2 = 0.0000000
               |grad[o]|=0.133  |grad[c]|= None  |ddm|=0.0535
macro iter 4 (21 JK  4 micro), CASSCF E = -3412.19023511022  dE = -0.088564971  S^2 = 0.0000000
               |grad[o]|=0.114  |grad[c]|= None  |ddm|=0.0371
macro iter 5 (21 JK  4 micro), CASSCF E = -3412.22705750153  dE = -0.036822391  S^2 = 0.0000000
               |grad[o]|=0.0465  |grad[c]|= None  |ddm|=0.0263
macro iter 6 (20 JK  4 micro), CASSCF E = -3412.22994952684  dE = -0.0028920253  S^2 = 0.0000000
               |grad[o]|=0.0224  |grad[c]|= None  |ddm|=0.0112
macro iter 7 (21 JK  4 micro), CASSCF E = -3412.23038661861  dE = -0.00043709178  S^2 = 0.0000000
               |grad[o]|=0.0066  |grad[c]|= None  |ddm|=0.00644
macro iter 8 (21 JK  4 micro), CASSCF E = -3412.23042956505  dE = -4.2946432e-05  S^2 = 0.0000000
               |grad[o]|=0.00197  |grad[c]|= None  |ddm|=0.00287
macro iter 9 (24 JK  4 micro), CASSCF E = -3412.23043029616  dE = -7.3110959e-07  S^2 = 0.0000000
               |grad[o]|=0.000399  |grad[c]|= None  |ddm|=0.000762
macro iter 10 (8 JK  1 micro), CASSCF E = -3412.23043000712  dE = 2.890356e-07  S^2 = 0.0000000
               |grad[o]|=0.000107  |grad[c]|= None  |ddm|=9.9e-05
macro iter 11 (7 JK  1 micro), CASSCF E = -3412.23042946482  dE = 5.4229986e-07  S^2 = 0.0000000
               |grad[o]|=8.08e-05  |grad[c]|= None  |ddm|=7.4e-05
macro iter 12 (6 JK  1 micro), CASSCF E = -3412.2304291159  dE = 3.4891946e-07  S^2 = 0.0000000
               |grad[o]|=5.43e-05  |grad[c]|= None  |ddm|=5.26e-05
macro iter 13 (4 JK  1 micro), CASSCF E = -3412.23042891773  dE = 1.9817571e-07  S^2 = 0.0000000
               |grad[o]|=4.11e-05  |grad[c]|= None  |ddm|=4.71e-05
macro iter 14 (3 JK  1 micro), CASSCF E = -3412.23042880951  dE = 1.0821441e-07  S^2 = 0.0000000
               |grad[o]|=4.14e-05  |grad[c]|= None  |ddm|=1.42e-05
macro iter 15 (3 JK  1 micro), CASSCF E = -3412.23042881319  dE = -3.6784513e-09  S^2 = 0.0000000
               |grad[o]|=3.2e-05  |grad[c]|= None  |ddm|=4.81e-06
1-step CASSCF converged in 15 macro (222 JK 42 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.9844518  1.97380286 1.96421366 1.9870187  1.98872324 1.9873989
 1.98893437 1.98626862 1.89076816 1.98312617 1.93186972 1.96569109
 1.9731918  1.65478413 0.44591044 0.01119845 0.01932935 0.08205354
 0.02277208 0.01289711 0.01830202 0.01045727 0.0099685  0.00660138
 0.01273128 0.01399484 0.01597496 0.00873015 0.0174642  0.0103873
 0.01108067 0.00990331]
CASSCF energy = -3412.23042881319
CASCI E = -3412.23042881319  E(CI) = -188.342556612367  S^2 = 0.0000000
